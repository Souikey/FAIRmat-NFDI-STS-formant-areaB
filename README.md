# Scanning tunneling specstroscopy / STS
[STS](https://en.wikipedia.org/wiki/Scanning_tunneling_spectroscopy) was developed scanning tunneling microscopy (STM) to probe surface electronic structure in real
space has been plagued by a number of experimental problems. In one reported approach by [R. J. Hamers et.al. in Physical Review Letters](https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.56.1972), I vs V or dl/dV vs V curves are measured without scanning. While such curves contain electronic structure information, the lateral position of the tip is uncertain and real-space images of the surface states are not obtained. Alternatively, images of dl/dV may be acquired at various bias voltages. First published by [G. Binnig et al. in Physical Review Letters](https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.55.991).

In the following decade a series of instruments had become available and employed in a wide field of experiments spanning from physics through materials science to cellular biphysics.

# Scanning tunneling specstroscopy / STS
X (m)	-890.53E-12	
Y (m)	29.6968E-9	
Z (m)	130.5E-9	
Z offset (m)	0E+0	
Settling time (s)	2.1E-3	
Integration time (s)	150E-6	
Z-Ctrl hold	TRUE	
Final Z (m)	N/A	
Start time	23.11.2022 18:55:16	
Filter type	Butterworth	
Order	1	
Cutoff frq	0,01	
Comment01	SYNC & Filter LP 8order WITHDRAW 600 steps, locked Au(111), 50pA, 100 mV set point, 1mV DCA, 973Hz,138 1st H, -84  2nd H	
Bias>Bias (V)	100E-3	
Bias>Calibration (V/V)	1E+0	
Bias>Offset (V)	0E+0	
Bias Spectroscopy>Sweep Start (V)	-300E-3	
Bias Spectroscopy>Sweep End (V)	300E-3	
Bias Spectroscopy>Num Pixel	4096	
Bias Spectroscopy>Z Avg time (s)	100E-3	
Bias Spectroscopy>Z offset (m)	0E+0	
Bias Spectroscopy>1st Settling time (s)	2.1E-3	
Bias Spectroscopy>Settling time (s)	2.1E-3	
Bias Spectroscopy>Integration time (s)	150E-6	
Bias Spectroscopy>End Settling time (s)	4E-3	
Bias Spectroscopy>Z control time (s)	200E-3	
Bias Spectroscopy>Max Slew rate (V/s)	1E+0	
Bias Spectroscopy>backward sweep	TRUE	
Bias Spectroscopy>Z-controller hold	TRUE	
Bias Spectroscopy>Number of sweeps	100	
Bias Spectroscopy>Channels	Current (A);LI Demod 2 X (A);LI Demod 2 Y (A);LI Demod 1 X (A);LI Demod 1 Y (A)	
Bias Spectroscopy>Reset Bias	TRUE	
Bias Spectroscopy>Record final Z	FALSE	
Bias Spectroscopy>Lock-In run	FALSE	
Current>Current (A)	-5.3429E-15	
Current>Calibration (A/V)	100E-12	
Current>Offset (A)	16.2897E-15	
Current>Gain	Not switchable	
Lock-in>Lock-in status	ON	
Lock-in>Modulated signal	Bias (V)	
Lock-in>Frequency (Hz)	973E+0	
Lock-in>Amplitude	2E-3	
Lock-in>Demodulated signal	Current (A)	
Lock-in>HP Filter Cutoff D1 (Hz)	621.699E+0	
Lock-in>HP Filter Cutoff D2 (Hz)	621.699E+0	
Lock-in>HP Filter Order D1	1	
Lock-in>HP Filter Order D2	1	
Lock-in>Harmonic D1	1	
Lock-in>Harmonic D2	2	
Lock-in>Reference phase D1 (deg)	137.597E+0	
Lock-in>Reference phase D2 (deg)	-83.6562E+0	
Lock-in>LP Filter Cutoff D1 (Hz)	621.699E+0	
Lock-in>LP Filter Cutoff D2 (Hz)	621.699E+0	
Lock-in>LP Filter Order D1	8	
Lock-in>LP Filter Order D2	8	
Lock-in>Sync Filter D1	ON	
Lock-in>Sync Filter D2	ON	
NanonisMain>Session Path	C:\Users\SPM-PEEM\Desktop\DATA_Nanonis\20220711_CreaTec_Service_Benchmarks_LHe\Nanonis-Session-PMD100-HVHU_CreaTec_Service_PalmaLabBerlin220711	
NanonisMain>SW Version	Generic 5e	
NanonisMain>UI Release	10771	
NanonisMain>RT Release	10771	
NanonisMain>RT Frequency (Hz)	20E+3	
NanonisMain>Signals Oversampling	10	
NanonisMain>Acquisition Period (s)	20E-3	
NanonisMain>Animations Period (s)	20E-3	
NanonisMain>Indicators Period (s)	300E-3	
NanonisMain>Measurements Period (s)	500E-3	
Outputs>Output 0 Mode	User Output	
Outputs>Output 1 Mode	User Output	
Outputs>Output 2 Mode	User Output	
Outputs>Output 3 Mode	User Output	
Outputs>Output 4 Mode	User Output	
Outputs>Output 5 Mode	User Output	
Outputs>Output 6 Mode	User Output	
Outputs>Output 7 Mode	User Output	
Outputs>Output 0 Value	0E+0	
Outputs>Output 1 Value	0E+0	
Outputs>Output 2 Value	0E+0	
Outputs>Output 3 Value	2.5539E+0	
Outputs>Output 4 Value	0E+0	
Outputs>Output 5 Value	0E+0	
Outputs>Output 6 Value	0E+0	
Outputs>Output 7 Value	0E+0	
Outputs>Output 0 Name	Input 24 (V)	
Outputs>Output 1 Name	Bias (V)	
Outputs>Output 2 Name	Output 2 (V)	
Outputs>Output 3 Name	T1 Supply voltage (V)	
Outputs>Output 4 Name	Output 4 (V)	
Outputs>Output 5 Name	X (m)	
Outputs>Output 6 Name	Y (m)	
Outputs>Output 7 Name	Z (m)	
Outputs>Output 0 Slew Rate	Inf	
Outputs>Output 1 Slew Rate	Inf	
Outputs>Output 2 Slew Rate	Inf	
Outputs>Output 3 Slew Rate	Inf	
Outputs>Output 4 Slew Rate	Inf	
Outputs>Output 5 Slew Rate	Inf	
Outputs>Output 6 Slew Rate	Inf	
Outputs>Output 7 Slew Rate	Inf	
Piezo Configuration>Active Calib.	LHe	
Piezo Configuration>Calib. X (m/V)	3.8E-9	
Piezo Configuration>Calib. Y (m/V)	3.8E-9	
Piezo Configuration>Calib. Z (m/V)	900E-12	
Piezo Configuration>HV Gain X	14.5	
Piezo Configuration>HV Gain Y	14.5	
Piezo Configuration>HV Gain Z	14.5	
Piezo Configuration>Tilt X (deg)	0.318343	
Piezo Configuration>Tilt Y (deg)	1.584	
Piezo Configuration>Curvature radius X (m)	Inf	
Piezo Configuration>Curvature radius Y (m)	Inf	
Piezo Configuration>2nd order corr X (V/m^2)	0E+0	
Piezo Configuration>2nd order corr Y (V/m^2)	0E+0	
Piezo Configuration>Drift X (m/s)	0E+0	
Piezo Configuration>Drift Y (m/s)	0E+0	
Piezo Configuration>Drift Z (m/s)	0E+0	
Piezo Configuration>Drift correction status (on/off)	FALSE	
Scan>Scanfield	3.11737E-9;29.1583E-9;15E-9;15E-9;0E+0	
Scan>series name	221122_Au_5K	
Scan>channels	Current (A);Bias (V);Z (m);LI Demod 2 X (A);LI Demod 2 Y (A);LI Demod 1 X (A);LI Demod 1 Y (A)	
Scan>pixels/line	512	
Scan>lines	512	
Scan>speed forw. (m/s)	11.7187E-9	
Scan>speed backw. (m/s)	11.7187E-9	
Temperature 1>Temperature 1 (K)	4.92997E+0	
Z-Controller>Z (m)	130.5E-9	
Z-Controller>Controller name	log Current	
Z-Controller>Controller status	OFF	
Z-Controller>Setpoint	50E-12	
Z-Controller>Setpoint unit	A	
Z-Controller>P gain	6E-12	
Z-Controller>I gain	39.8241E-9	
Z-Controller>Time const (s)	150.662E-6	
Z-Controller>TipLift (m)	0E+0	
Z-Controller>Switch off delay (s)	0E+0


# Historical comments
The idea of measuring colloidal forces and topography are not completely new. However, the first device that had managed to reproducively measure colloidal forces on surfaces was reported in [1969 by Israelachvili, Tabor and Winterton](https://www.jstor.org/stable/2416454?origin=JSTOR-pdf#metadata_info_tab_contents), which lead to the development of the surface forces apparatus (SFA).

Another direction was characterizing surface topography on the microscopic scale, which was leading to [profilometers](https://en.wikipedia.org/wiki/Profilometer) based on a contact stylus or optical interference.

# Disambiguation
A key element of an AFM is the positioning system used to scan the surface and move the probe above the surface. This is in general is based on the [piezoelectric effect](https://en.wikipedia.org/wiki/Piezoelectricity) or more its inverse, where one applies a voltage on a piezoelectric crystal and that changes its length (deforms) as a consequence.

Now, the name implies that we are investigating forces acting on a probe at atomic scale. To detect forces, we usually convert the force to deformation using a sensor. The original paper described a microscopic leaf spring with a tip attached to its surface. The tip was interacing with the surface, causing a deflection of the microscopic spring, which deflection was detected using a capacitive sensor system.

## contact mode AFM
This method is what today is known as contact mode atomic force microscopy. Even in this simple case we have two modes of operation possible:
 - scan the head (or sample) in the XY plane and follow the deflection of the sensor;
 - decide on a certain deflection level (and thus force) and keep it constant, adjusting the distance of the probe from the surface accordingly, and record the changes in the Z direction.

The former easily results in breaking the probe, and the latter is the one what is today used in most instruments.

## friction force images
When the scan is performed with a fast axis in the direction perpendicular of the long axis of the cantilever, the interaction to the surface also causes a twist of the cantilever, which is detected (most commonly) as the left-right signal on the segmented photodetector. Comparing this signal between scanning a line forwards and backwards (trace and retrace), we get information characteristic to the interaction (friction).

## non-contact or intermittent-contact modes
To find a less invasive method to image soft surfaces, another way was developed. Leaf springs always have a resonance frequency if oscillated. Oscillating the probe near or at its reasonance, the amplitude and phase (between the driving oscilation and the actual motion of the cantilever) will be sensitive to the interaction to the surface.

Though non-contact mode is very sensitive and non-invasive, it turned out to be difficult to use, prone to drift and noise.

An alternative solution was to bring the oscillating probe to touch the surface, causing a decrease in the oscillation amplitude let us say at about 90% of the free oscillation. Then maintain this oscillation amplitude in the feedback loop and scan the topography of the surface.

## other ways of probing
The topography measured with a feedback system will always depend on the real topography of the surface (which is the hard wall limit of the material) and interaction between the probe and the material on / of the surface.

Thus, if we have a way of tuning this interaction using:
 - tips of specific chemistry (functionalized or fabricated of specific materials)
 - conductive or semiconductive tips and controlled potential / current
 - magnetic material based tips
 - etc.

## quantitative imaging
A little different method has become available with the development of computers and data processing in thepast few decades. This method measures the force - separation distance curves at every XY point on the surface and determines various mechanical parameters, such as elasticity (Young's modulus) or maximal force of adhesion. The QI mode produces large data sets and is claimed to be very quantitative.

# Force detection
In all cases the key sensor is a microscopic leaf-spring, a cantilever with submillimeter length and a few micrometers of thickness. Its deflection can be detected in various ways.

The original system used a cantilever coated with a metal film, and a capacitive sensor to see its vertical deflection.

Moderns devices mostly use a light pointer, the displacement of light reflected from the back side of the cantilever projected onto a segmented photodiode. Using such an optical detector allows for a very sensitive detection of changes in bending (tilt of the 'mirror').

# Calibration
Thus, detectors provide some kind of electic signal proportional to the force acting on the cantilever. Usually this signal has to be first converted to an actual deflection (using the sensor response) and then to force (using the spring constant).

## sensor response
The simplest way of detecting the sensor response is to push the probe to a hard surface when any motion of the back end of the cantilever directly relates to the sensor signal, and the slope of this straight curve indicates the sensor response.

Alternatively the oscillation amplitude of a free standing cantilever with known spring constant (usually derived from its geometry and material properties) can be employed.

## spring constant
There are a set of possibilities to estimate the spring constant of a cantilever:
 - estimate it based on the material properties and the geometry of the cantilever
 - thermal oscillation / oscillation resonance of the cantilever
 - apply a set of particles with known weight and measure deflection
 - bend the cantilever agains a known cantilever and follow the bending of both

From these, the first two are the most common ones nowadays, and both have their problems of accuracy.

### geometric correction
There is a deviation between the two methods of detecting deflection / spring constant, coming from the fact that the deformation shape is different between the two methods. This may result in a typical 20-30% deviation between the real value and the measured value both for the spring constant or the sensor response.

The correction also depends on the geometry of the cantilever, most commonly a rectangular beam or an A-shaped spring.

## calibration for friction
The two key parameters are similar, but different than above. Again we need a sensor response describing the relation between the detected signal and the twist angle, then this angle and the actual torque.


# Force measurements
While it is usually a different way of operating an AFM, generating force-distance curves, it is directly employed in quantitative imaging mode.

Force-distance curves are measured driving the vertical position of the probe either moving the sample or the probe. This direction is denoted usually as Z-axis.

There are two main modes used in this measurement:
 - driving the Z-positioner with a predefined speed and detect the force (and Z-position)
 - maintain a constant force by moving the Z-position, the so called force-clamp mode

In both modes the probe is pushed to the surface up to a predefined maximal force, and then the actual measurement begins.
Force-distance scans still report the X,Y piezo position of the head, thus it is possible to create maps of derived model parameters.

# Reporting scans
From the description above it is clear that not all experiments can be described using the same parameters. There is a major difference between contact and non-contact methods. All may require to have a proper sensor response and spring constant calibration, but the latter also require a free oscillation resonance measured. Other SPM methods will require further parameters, but these can be easily appended.

The instruments actually record numeric values from analog to digital (A/D) converters, which are first converted to voltage or current based on hardware parameters, then to physical units based on calibration of the components.

## piezo positions
Piezoelectric stacs show a non-linear characteristics in their voltage - position relation. Usually this is approximated as a second order polynomial, and is calibrated by the manufacturer using interferomentic position measurements.

Since these stacks age, thus their parameters change with time, every system provides means to tune these parameters based on scans of reference samples (provided by the manufacturer).
Another way of countering this problem is that many models developed after about 2000 includes capacitive sensor based position detection to measure the actual position of the various piezo actuators.
Capacitive sensors are less accurate than the interferometric method, but also robust and stable. (Less accurate meaning typically +/- 1-2 nm.)

Thus, the devices often record the piezo positions based on the voltage applied to the piezo stacks, and another set as 'measured' positions.

## file formats
Most systems report data in proprietary file formats. These may contain all necessary information about the scanner, calibration parameters, etc., but reading them can be complicated.

### Gwyddeon
The open source software [Gwyddion](https://github.com/christian-sahlmann/gwyddion) is capable of reading many of the available file formats, and provides an OSS output version for other users.
The original [website](https://gwyddion.net/) is down for a few months now, the active page is at [Sourceforge](https://sourceforge.net/p/gwyddion/blog/).

## Common reported parameters
### cantilevers / probes
 - probe name and supplier, e.g. PPP-NCLR tapping mode probe from Nanoandmore
 - probe geometry type: beam shape
 - probe material (nominal): Si
 - coating: Al backside film
 - nominal length: 225 micrometer
 - nominal resonance frequency: 190 kHz
 - nominal spring constant: 48 N/m
 - nominal tip radius: 7 nm

Not every imaging requires full calibration of the probes, but if that was performed, report:
 - sensore response
 - spring constant
 - what method was used to calibrate
 - calibration data
 - temperature

If the probe was modified or cleaned prior measurement that is an experiment to be
referenced here.

### scan parameters
 - set point
 - image size in micrometers
 - image size in pixels
 - scanning frequency (one full trace and retrace scan / second)
 - scanning speed (optional)
 - integral gain
 - proportional gain
 - differential gain (if available)
 - dynamic parameter adjustment used (e.g. scanAssyst)

### for non-contact modes
 - free oscillation frequency in kHz
 - set oscillation frequency in kHs
 - free oscillation amplitude
(We can assume that phase was set to zero at free oscillation close to the surface.)

### for QI mode or force modulation mode
 - force oscillation frequency
 - force oscillation amplitude
